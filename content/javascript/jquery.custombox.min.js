(function(e,t,n,r){"use strict";function o(e,t){this.element=e;if(typeof this.element==="object"&&typeof t==="object"&&isNaN(t.zIndex)&&t.zIndex==="auto"){t.zIndex=this._isIE()?s.zIndex:this._zIndex()}this.settings=this._extend({},s,t);if(typeof this.element==="object"){this._box.init(this)}else{this[this.element]()}}var i="custombox",s={url:null,cache:false,escKey:true,eClose:null,zIndex:9999,overlay:true,overlayColor:"#000",overlayOpacity:.8,overlayClose:true,overlaySpeed:200,customClass:null,width:null,height:null,effect:"fadein",position:null,speed:600,open:null,complete:null,close:null,responsive:true,scrollbar:false,error:"Error 404!"};o.prototype={_overlay:function(){var e=this._hexToRgb(this.settings.overlayColor),t={};if(navigator.appVersion.indexOf("MSIE 8.")!=-1){t.backgroundColor=this.settings.overlayColor;t.zIndex=parseFloat(this.settings.zIndex)+1;t.filter="alpha(opacity="+this.settings.overlayOpacity*100+")"}else{t["background-color"]="rgba("+e.r+","+e.g+", "+e.b+","+this.settings.overlayOpacity+")";t["z-index"]=parseFloat(this.settings.zIndex)+1;t["transition"]="all "+this.settings.overlaySpeed/1e3+"s"}n.getElementsByTagName("body")[0].appendChild(this._create({id:"overlay",eClass:"overlay"},t))},_box:{init:function(e){if(e.settings.open&&typeof e.settings.open==="function"){e.settings.open(r!==arguments[0]?arguments[0]:"")}if(e.settings.url===null){if(e.element!==null){e.settings.url=e.element.getAttribute("href")}}if(typeof e.settings.url==="string"){if(e.settings.url.charAt(0)==="#"||e.settings.url.charAt(0)==="."){if(n.querySelector(e.settings.url)){e._box.build(e,n.querySelector(e.settings.url).cloneNode(true))}else{e._box.build(e,null)}}else{this.ajax(e)}}else{e._box.build(e,null)}},create:function(e){var t={};if(e._isIE()){t.zIndex=parseFloat(e.settings.zIndex)+2}else{t["z-index"]=parseFloat(e.settings.zIndex)+2}var r=e._create({id:"modal",eClass:"modal "+e._box.effect(e)+(e.settings.customClass?" "+e.settings.customClass:"")},t),i=e._create({id:"modal-content",eClass:"modal-content"},{"transition-duration":e.settings.speed+"ms"});r.appendChild(i);n.body.insertBefore(r,n.body.firstChild);if(e.settings.overlay){e._overlay()}return[r,i]},effect:function(e){var t=["slide","flip","rotate"],r=["letmein","makeway","slip","blur"],s=i+"-"+e.settings.effect,o="";if(e.settings.position!==null&&e.settings.position.indexOf(",")!==-1){e.settings.position=e.settings.position.split(",");if(e.settings.position.length>1){o=" "+i+"-"+e.settings.effect+"-"+e.settings.position[0].replace(/^\s+|\s+$/g,"")+"-"+e.settings.position[1].replace(/^\s+|\s+$/g,"")}}for(var u=0,a=t.length;u<a;u++){if(t[u]===e.settings.effect){s=i+"-"+e.settings.effect+"-"+(o!==""?e.settings.position[0]:e.settings.position)+o}}for(var f=0,l=r.length;f<l;f++){if(r[f]===e.settings.effect){if(e.settings.effect!=="blur"){e._addClass(n.getElementsByTagName("html")[0],"perspective")}var c=n.createElement("div");c.className=i+"-container";while(n.body.firstChild){c.appendChild(n.body.firstChild)}n.body.appendChild(c)}}return s},build:function(e,s){var o=n.body,u=n.documentElement,a=u&&u.scrollTop||o&&o.scrollTop||0;if(e.settings.error!==false&&typeof e.settings.error==="string"){if(s===null){s=n.createElement("div");e._addClass(s,"error");s.innerHTML=e.settings.error}var f=e._box.create(e);f[1].appendChild(s);s.style.display="block";f[0].setAttribute("data-"+i+"-scroll",a);var l={width:parseInt(e.settings.width,0),height:parseInt(e.settings.height,0)};if(!isNaN(l.width)&&l.width===e.settings.width&&l.width.toString()===e.settings.width.toString()&&l.width!==null){s.style.width=l.width+"px"}if(!isNaN(l.height)&&l.height===e.settings.height&&l.height.toString()===e.settings.height.toString()&&l.height!==null){s.style.height=l.height+"px"}var c=s.offsetWidth,h={"margin-left":-c/2+"px",width:c+"px"};if(e._isIE()){var p=s.offsetHeight;h["margin-top"]=-p/2+"px";h["height"]=p+"px"}if(e.settings.position!==null&&e.settings.position.indexOf("top")!==-1){h["transform"]="none"}e._create({},h,f[0]);var d={width:"innerWidth"in t?t.innerWidth:n.documentElement.offsetWidth,height:"innerHeight"in t?t.innerHeight:n.documentElement.offsetHeight};if(!e.settings.scrollbar){if(s.offsetHeight<d.height&&o.offsetHeight>d.height){var v=e._create({},{visibility:"hidden",width:"100px"});o.appendChild(v);var m=v.offsetWidth;v.style.overflow="scroll";var g=e._create({},{width:"100%"});v.appendChild(g);var y=g.offsetWidth;v.parentNode.removeChild(v);o.style.marginRight=m-y+"px";e._addClass(n.getElementsByTagName("html")[0],"hide-scrollbar")}else{e._scrollbar(f[0])}}else{e._scrollbar(f[0])}if(e.settings.responsive){e._box.responsive(e,f,s,d)}setTimeout(function(){e._listeners(a);f[0].className+=" "+i+"-show";var n=f[1].getElementsByTagName("script");for(var s=0,o=n.length;s<o;s++){(new Function(n[s].text))()}if(t.attachEvent){setTimeout(function(){if(e.settings.complete&&typeof e.settings.complete==="function"){e.settings.complete(r!==arguments[0]?arguments[0]:"")}},e.settings.speed)}else{var u=true;f[0].addEventListener(e._crossBrowser(),function(){if(u){u=false;if(e.settings.complete&&typeof e.settings.complete==="function"){e.settings.complete(r!==arguments[0]?arguments[0]:"")}}},false)}},e.settings.overlay?e.settings.overlaySpeed:200)}},responsive:function(e,n,r,s){r.setAttribute("data-"+i+"-width",r.offsetWidth);e._create({},{width:"auto"},r);if(s.width<r.offsetWidth){e._create({},{width:s.width-40+"px","margin-left":"20px","margin-right":"20px",left:0},n[0])}var o="onorientationchange"in t,u=o?"orientationchange":"resize";if(t.attachEvent){t.attachEvent(u,function(){a(this)},false)}else{t.addEventListener(u,function(){a(this)},false)}var a=function(s){if(typeof t.orientation==="undefined"){if(r.getAttribute("data-"+i+"-width")!==null){var o=r.getAttribute("data-"+i+"-width");if(o>s.innerWidth){e._create({},{width:s.innerWidth-40+"px","margin-left":"20px","margin-right":"20px",left:0},n[0])}else{e._create({},{width:o+"px","margin-left":-o/2+"px",left:"50%"},n[0])}}}else{e._create(null,{width:s.innerWidth-40+"px","margin-left":"20px","margin-right":"20px",left:0},n[0])}}},ajax:function(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){var r=4;if(t.readyState===r){if(t.status===200){var i=n.createElement("div");i.innerHTML=t.responseText;e._box.build(e,i)}else{e._box.build(e,null)}}};t.open("GET",e.settings.url+(!e.settings.cache?"?_="+(new Date).getTime():""),true);t.setRequestHeader("X-Requested-With","XMLHttpRequest");t.send(null)}},_close:function(){var e=this;setTimeout(function(){e._removeClass(n.getElementsByTagName("html")[0],i+"-hide-scrollbar");n.getElementsByTagName("body")[0].style.marginRight=0;var s=e._isIE()?n.querySelectorAll("."+i+"-modal")[0]:n.getElementsByClassName(i+"-modal")[0];e._remove(s);if(e.settings.overlay){e._remove(e._isIE()?n.querySelectorAll("."+i+"-overlay")[0]:n.getElementsByClassName(i+"-overlay")[0])}if(e.settings.close&&typeof e.settings.close==="function"){e.settings.close(r!==arguments[0]?arguments[0]:"")}else if(typeof s!=="undefined"&&s.getAttribute("data-"+i)!==null){var o=s.getAttribute("data-"+i),u=(new Function("onClose","return "+o))(o);u()}t.top.scroll(0,s.getAttribute("data-"+i+"-scroll"))},e.settings.speed);e._addClass(e._isIE()?n.querySelectorAll("."+i+"-modal")[0]:n.getElementsByClassName(i+"-modal")[0],"close");e._removeClass(e._isIE()?n.querySelectorAll("."+i+"-modal")[0]:n.getElementsByClassName(i+"-modal")[0],i+"-show");e._removeClass(n.getElementsByTagName("html")[0],i+"-perspective")},_listeners:function(){var e=this;if(e._isIE()){if(typeof n.querySelectorAll("."+i+"-overlay")[0]!=="undefined"&&e.settings.overlayClose){n.querySelectorAll("."+i+"-overlay")[0].attachEvent("onclick",function(){e._close()})}}else{if(typeof n.getElementsByClassName(i+"-overlay")[0]!=="undefined"&&e.settings.overlayClose){n.getElementsByClassName(i+"-overlay")[0].addEventListener("click",function(){e._close()},false)}}if(e.settings.escKey){n.onkeydown=function(n){n=n||t.event;if(n.keyCode===27){e._close()}}}if(e.settings.eClose!==null&&typeof e.settings.eClose==="string"&&e.settings.eClose.charAt(0)==="#"||typeof e.settings.eClose==="string"&&e.settings.eClose.charAt(0)==="."&&n.querySelector(e.settings.eClose)){n.querySelector(e.settings.eClose).addEventListener("click",function(){e._close()},false)}if(e.settings.close&&typeof e.settings.close==="function"){var r=e.settings.close;var s=e._isIE()?n.querySelectorAll("."+i+"-modal")[0]:n.getElementsByClassName(i+"-modal")[0];s.setAttribute("data-"+i,r)}},_extend:function(){for(var e=1,t=arguments.length;e<t;e++){for(var n in arguments[e]){if(arguments[e].hasOwnProperty(n)){arguments[0][n]=arguments[e][n]}}}return arguments[0]},_create:function(e,t,s){var o=s===r||s===null?n.createElement("div"):s;Object.keys=Object.keys||function(e){var t=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(n)}}return t};if(e!==null&&Object.keys(e).length!==0){if(e.id!==null){o.id=i+"-"+e.id}if(e.eClass!==null){this._addClass(o,e.eClass)}}if(t!==null){for(var u in t){if(t.hasOwnProperty(u)){if(this._isIE()){var a=u.split("-");if(a.length>1){a=a[0]+a[1].replace(/(?:^|\s)\w/g,function(e){return e.toUpperCase()})}o.style[a]=t[u]}else{o.style.setProperty(u,t[u],null)}if((u.indexOf("transition")!==-1||u==="transform"!==-1)&&!this._isIE()){var f=["-webkit-","-ms-"];for(var l=0,c=f.length;l<c;l++){o.style.setProperty(f[l]+u,t[u],null)}}}}}return o},_hexToRgb:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,n,r){return t+t+n+n+r+r});var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null},_addClass:function(e,t){if(!this._hasClass(e,t)){e.className=e.className.length&&e.className!==" "?e.className+" "+i+"-"+t:i+"-"+t}},_removeClass:function(e,t){if(this._hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}},_hasClass:function(e,t){return e!==r?e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)")):false},_remove:function(e){if(e!==r){e.parentNode.removeChild(e)}},_zIndex:function(){var e=n,t=e.getElementsByTagName("*"),r=0;for(var i=0,s=t.length;i<s;i++){var o=e.defaultView.getComputedStyle(t[i],null).getPropertyValue("z-index");if(o>r&&o!=="auto"){r=o}}return r},_isIE:function(){return navigator.appVersion.indexOf("MSIE 9.")!=-1||navigator.appVersion.indexOf("MSIE 8.")!=-1},_crossBrowser:function(){var e=n.createElement("fakeelement"),t={transition:"transitionend",WebkitTransition:"webkitTransitionEnd"},i;for(var s in t){if(t.hasOwnProperty(s)&&e.style[s]!==r){i=t[s]}}return i},_scrollbar:function(e){var n=this;setTimeout(function(){t.scrollTo(0,0)},n.settings.overlay?n.settings.overlaySpeed:200);var r={position:"absolute"};if(n.settings.position!==null&&n.settings.position.indexOf("top")!==-1){r["top"]=0;r["margin-top"]="20px"}n._create({},r,e)},close:function(){this._close()}};e.fn[i]=function(t){var n=arguments,s=typeof HTMLElement==="object"?t instanceof HTMLElement:t&&typeof t==="object"&&t!==null&&t.nodeType===1&&typeof t.nodeName==="string";if(t===r||typeof t==="object"){if(s){if(navigator.appName==="Microsoft Internet Explorer"){var u=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(u.exec(navigator.userAgent)!=null){var a=parseInt(RegExp.$1)}}if(typeof a==="undefined"||a>=10){if(t.getAttribute("data-"+i)!==null&&parseInt(t.getAttribute("data-"+i))+1>Math.round((new Date).getTime()/1e3)){return}t.setAttribute("data-"+i,Math.round((new Date).getTime()/1e3))}e(t).each(function(){e.data(this,i,new o(this,n[1]))})}else{new o(null,n[0])}}else if(typeof t==="string"&&t==="close"){e.data(this,i,new o(n[0],n[1]))}}})(jQuery,window,document)